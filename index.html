<!-- index.html -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Agenda Esportiva</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #121212; color: #fff; margin: 0; padding: 20px; }
    .event { background: #1e1e1e; border-radius: 10px; padding: 15px; margin-bottom: 15px; box-shadow: 0 0 10px rgba(0,0,0,0.4); }
    .event h2 { margin: 0 0 10px; font-size: 1.2em; color: #f39c12; }
    .event time { display: block; margin-bottom: 10px; font-weight: bold; }
    .channels a { display: inline-block; margin: 3px; padding: 6px 10px; background: #2c3e50; color: #fff; border-radius: 5px; text-decoration: none; font-size: 0.9em; transition: background 0.2s; }
    .channels a:hover { background: #34495e; }
  </style>
</head>
<body>
  <h1>Eventos ao Vivo</h1>
  <div id="event-list">Carregando eventos...</div>

  <script>
    const apiUrl = 'https://pelota-api.netlify.app/.netlify/functions/api';

    function formatTime(utcTime) {
      const [hours, minutes] = utcTime.split(':');
      const utcDate = new Date();
      utcDate.setUTCHours(parseInt(hours), parseInt(minutes));
      const brDate = new Date(utcDate.getTime() - 3 * 60 * 60 * 1000);
      return brDate.toTimeString().substring(0, 5);
    }

    fetch(apiUrl)
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById('event-list');
        container.innerHTML = '';
        data.forEach(event => {
          const div = document.createElement('div');
          div.className = 'event';
          div.innerHTML = `
            <h2>${event.title}</h2>
            <time>‚è∞ ${formatTime(event.time)}</time>
            <div class="channels">
              ${event.channels.map(canal => `
                <a href="iframe.html?url=${encodeURIComponent(canal.link)}" target="_blank">${canal.name}</a>
              `).join('')}
            </div>
          `;
          container.appendChild(div);
        });
      })
      .catch(() => {
        document.getElementById('event-list').innerText = 'Erro ao carregar eventos.';
      });
  </script>
</body>
</html>